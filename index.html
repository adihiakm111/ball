<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Tilt Wall Game</title>

<style>
body{
  margin:0;
  height:100vh;
  background:#0f0f0f;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  font-family:Arial;
  color:white;
  overflow:hidden;
}

/* HUD */
#hud{
  display:flex;
  gap:30px;
  margin-bottom:15px;
  font-size:22px;
}

/* GAME TRACK */
#main{
  position:relative;
  width:100vw;
  max-width:1200px;
  height:100px;
  background:#2b2b2b;
  border-radius:40px;
  overflow:hidden;
}

/* CENTER WALL */
#main::after{
  content:"";
  position:absolute;
  left:50%;
  top:0;
  width:6px;
  height:100%;
  background:red;
  transform:translateX(-50%);
}

/* BALLS */
#a,#b{
  position:absolute;
  width:90px;
  height:90px;
  border-radius:50%;
  top:50%;
  transform:translateY(-50%);
}

#a{ background:#ff3b3b; }
#b{ background:#00e5ff; }

/* OVERLAYS */
#startScreen,
#rotate,
#gameover{
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  gap:20px;
  z-index:10;
}

#rotate,
#gameover{ display:none; }

button{
  font-size:22px;
  padding:12px 30px;
}
</style>
</head>

<body>

<!-- START -->
<div id="startScreen">
  <button id="startBtn">START GAME</button>
</div>

<!-- ROTATE -->
<div id="rotate">Phone ko LANDSCAPE me ghumao ðŸ”„</div>

<!-- HUD -->
<div id="hud">
  <div>TIME: <span id="timeScore">0</span></div>
  <div>HITS: <span id="hitScore">0</span></div>
</div>

<!-- GAME -->
<div id="main">
  <div id="a"></div>
  <div id="b"></div>
</div>

<!-- GAME OVER -->
<div id="gameover">
  <div style="font-size:36px;">GAME OVER</div>
  <button onclick="restart()">RESTART</button>
</div>

<script>
const main = document.getElementById("main");
const a = document.getElementById("a");
const b = document.getElementById("b");

const startScreen = document.getElementById("startScreen");
const rotateScreen = document.getElementById("rotate");
const gameOverBox  = document.getElementById("gameover");

const timeBox = document.getElementById("timeScore");
const hitBox  = document.getElementById("hitScore");
const startBtn = document.getElementById("startBtn");

let ax, bx;
let speed = 2.5;
let tilt = 0;
let running = false;

let timeScore = 0;
let hitScore = 0;

/* ===== SENSOR PERMISSION ===== */
startBtn.addEventListener("click", async ()=>{
  if(
    typeof DeviceOrientationEvent !== "undefined" &&
    typeof DeviceOrientationEvent.requestPermission === "function"
  ){
    const res = await DeviceOrientationEvent.requestPermission();
    if(res !== "granted"){
      alert("Tilt permission required");
      return;
    }
  }
  startScreen.style.display = "none";
  reset();
  checkOrientation();
  loop();
});

/* ===== ORIENTATION ===== */
function checkOrientation(){
  if(window.innerHeight > window.innerWidth){
    rotateScreen.style.display = "flex";
    running = false;
  }else{
    rotateScreen.style.display = "none";
    running = true;
  }
}
window.addEventListener("resize", checkOrientation);

/* ===== TILT ===== */
window.addEventListener("deviceorientation", e=>{
  tilt = e.gamma || 0;
});

/* ===== WALL DETECTION (SOLID) ===== */
function hitCenterWall(x, ball){
  const center = main.offsetWidth / 2;
  const wallHalf = 3;
  const wallLeft = center - wallHalf;
  const wallRight = center + wallHalf;

  const ballLeft = x;
  const ballRight = x + ball.offsetWidth;

  return ballRight > wallLeft && ballLeft < wallRight;
}

/* ===== RESET ===== */
function reset(){
  ax = 20;
  bx = main.offsetWidth - b.offsetWidth - 20;
  timeScore = 0;
  hitScore = 0;
  timeBox.innerText = "0";
  hitBox.innerText = "0";
  gameOverBox.style.display = "none";
}

/* ===== RESTART ===== */
function restart(){
  reset();
  running = true;
  loop();
}

/* ===== MAIN LOOP ===== */
function loop(){
  if(!running) return;

  let dir = 0;
  if(tilt > 4) dir = 1;
  if(tilt < -4) dir = -1;

  ax += speed * dir;
  bx += speed * dir;

  a.style.left = ax + "px";
  b.style.left = bx + "px";

  /* TIME SCORE */
  timeScore += 0.02;
  timeBox.innerText = timeScore.toFixed(1);

  /* BALL HIT COUNT */
  if(ax + a.offsetWidth >= bx){
    hitScore++;
    hitBox.innerText = hitScore;
    ax -= 10;
    bx += 10;
  }

  /* WALL = GAME OVER */
  if(hitCenterWall(ax, a) || hitCenterWall(bx, b)){
    running = false;
    gameOverBox.style.display = "flex";
    return;
  }

  requestAnimationFrame(loop);
}
</script>
</body>
</html>

